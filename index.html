<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

<script>
  // Firebase config
  var firebaseConfig = {
    apiKey: "AIzaSyDcAn84EYf0U26ubggBl5TOHkEFzHTiVnM",
    authDomain: "geoai-flood-control.firebaseapp.com",
    databaseURL: "https://geoai-flood-control-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "geoai-flood-control",
    storageBucket: "geoai-flood-control.firebasestorage.app",
    messagingSenderId: "290912556912",
    appId: "1:290912556912:web:a87b7886ea55f3b265a1b5"
  };

  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  var db = firebase.database();

  // ------------------------------------------
  // ðŸ”µ REALTIME LATEST VALUE
  // ------------------------------------------
  db.ref("flood-data/records").limitToLast(1).on("value", function(snapshot) {
    snapshot.forEach(function(child) {
      var data = child.val();
      document.getElementById("level").innerHTML = data.level + " cm";

      var date = new Date(data.timestamp * 1000);
      document.getElementById("time").innerHTML = date.toLocaleString();
    });
  });

  // ------------------------------------------
  // ðŸŸ¢ TABLE RECORDS (20 latest)
  // ------------------------------------------
  db.ref("flood-data/records").limitToLast(20).on("value", function(snapshot) {
    var table = document.getElementById("dataTable");
    table.innerHTML = `
      <tr>
        <th>Timestamp</th>
        <th>Level (cm)</th>
      </tr>
    `;
    snapshot.forEach(function(child) {
      var data = child.val();
      var date = new Date(data.timestamp * 1000);
      table.innerHTML += `
        <tr>
          <td>${date.toLocaleString()}</td>
          <td>${data.level} cm</td>
        </tr>
      `;
    });
  });
</script>
